<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Firefighter Sleep Disruption EDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="eda_files/libs/quarto-html/quarto.js"></script>
<script src="eda_files/libs/quarto-html/popper.min.js"></script>
<script src="eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eda_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eda_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="eda_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="eda_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="eda_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="eda_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="eda_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="eda_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="eda_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="eda_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="eda_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="eda_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Firefighter Sleep Disruption EDA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="purpose" class="level1">
<h1>Purpose</h1>
<p>Firefighters must respond to emergency calls during the night. These disruptions contribute significantly to long term physical and mental stress. While these disruptions cannot be prevented completely, knowing which stations and shifts are impacted the most and why can allow fire department command staff to implement policies or technology to mitigate them.</p>
<p>This exploratory data analyses serves to identify the quality and structure of anonymized data gathered from a fire department to inform deeper analysis.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>The data was first extracted from RMS and CAD databases using SQL. See the sql folder for more details. Next, the data was cleaned and transformed to a usable baseline in the script <code>01_data_prep.R</code>. Incident numbers, stations, and callsigns were anonymized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../datasets/incident_unit_responses.rds'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(incident_unit_responses_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-47e17f8723469c1c586e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-47e17f8723469c1c586e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["8d9153ec3421de5cbfe05915d7612f40","8d9153ec3421de5cbfe05915d7612f40","d180511d4e29974ca90e3ec141c4056a","d180511d4e29974ca90e3ec141c4056a","108d4f4a97fe9b7522d0bd69c209cb4c","36e529bf4060ca18aecef2da4fcfeeeb"],["Medical assist, assist EMS crew","Medical assist, assist EMS crew","CO detector activation due to malfunction","CO detector activation due to malfunction","Assist invalid","Arrived and cancelled on scene"],["311","311","736","736","554","611CS"],["119","119","111","111","117","113"],["R","E","E","T","EA","EA"],[26.6529998779297,26.6529998779297,30.5700001716614,54.603000164032,1.13700008392334,40.9270000457764],[37.7630000114441,40.1729998588562,56.1370000839233,2.00699996948242,38.9370000362396,48.8129999637604],["2021-12-01T00:12:26Z","2021-12-01T00:12:26Z","2021-12-01T00:44:30Z","2021-12-01T00:46:54Z","2021-12-01T01:04:01Z","2021-12-01T01:18:40Z"],[null,"2021-12-01T00:13:51Z","2021-12-01T00:46:11Z","2021-12-01T00:47:16Z","2021-12-01T01:05:27Z","2021-12-01T01:19:17Z"],[null,"2021-12-01T00:24:49Z",null,"2021-12-01T00:56:36Z","2021-12-01T01:13:00Z","2021-12-01T01:26:56Z"],["2021-12-01T00:14:37Z","2021-12-01T00:26:40Z","2021-12-01T00:46:56Z","2021-12-01T01:06:02Z","2021-12-01T01:19:38Z","2021-12-01T01:36:48Z"],[true,false,false,false,false,false],[false,false,true,false,false,false],[null,84.58400011062622,100.5269999504089,21.81699991226196,86.0699999332428,37.00299978256226],[null,658.4660000801086,null,560.0729999542236,452.9100000858307,458.8700001239777],[null,768.9359998703003,45.03999996185303,1125.586999893188,851.7300000190735,1050.883000135422],[null,110.4699997901917,null,565.5139999389648,398.8199999332428,592.0130000114441],[131.1100001335144,853.5199999809265,145.566999912262,1147.40399980545,937.7999999523163,1087.885999917984],[true,true,true,true,true,true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>incident_id<\/th>\n      <th>incident_type<\/th>\n      <th>incident_type_code<\/th>\n      <th>station_id<\/th>\n      <th>unit_type<\/th>\n      <th>dispatch_hour<\/th>\n      <th>clear_hour<\/th>\n      <th>dispatch_dt<\/th>\n      <th>enroute_dt<\/th>\n      <th>arrival_dt<\/th>\n      <th>clear_dt<\/th>\n      <th>cancelled_before_enroute_flag<\/th>\n      <th>cancelled_enroute_flag<\/th>\n      <th>turnout_time<\/th>\n      <th>travel_time<\/th>\n      <th>enroute_to_clear_time<\/th>\n      <th>scene_time<\/th>\n      <th>commit_time<\/th>\n      <th>night_call_flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"incident_id","targets":1},{"name":"incident_type","targets":2},{"name":"incident_type_code","targets":3},{"name":"station_id","targets":4},{"name":"unit_type","targets":5},{"name":"dispatch_hour","targets":6},{"name":"clear_hour","targets":7},{"name":"dispatch_dt","targets":8},{"name":"enroute_dt","targets":9},{"name":"arrival_dt","targets":10},{"name":"clear_dt","targets":11},{"name":"cancelled_before_enroute_flag","targets":12},{"name":"cancelled_enroute_flag","targets":13},{"name":"turnout_time","targets":14},{"name":"travel_time","targets":15},{"name":"enroute_to_clear_time","targets":16},{"name":"scene_time","targets":17},{"name":"commit_time","targets":18},{"name":"night_call_flag","targets":19}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The data is at the unit response level grain with unit type, incident type, station, times, and flags. Now we will examine the dataset further.</p>
<section id="data-summary" class="level2">
<h2 class="anchored" data-anchor-id="data-summary">Data Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(incident_unit_responses_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">incident_unit_responses_d…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">406509</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">difftime</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Timespan</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">incident_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">257959</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: difftime</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">turnout_time</td>
<td style="text-align: right;">15866</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: left;">-82.48 secs</td>
<td style="text-align: left;">7639.21 secs</td>
<td style="text-align: left;">43.17 secs</td>
<td style="text-align: right;">119594</td>
</tr>
<tr class="even">
<td style="text-align: left;">travel_time</td>
<td style="text-align: right;">133744</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: left;">-2953.67 secs</td>
<td style="text-align: left;">14805.29 secs</td>
<td style="text-align: left;">405.22 secs</td>
<td style="text-align: right;">211383</td>
</tr>
<tr class="odd">
<td style="text-align: left;">enroute_to_clear_time</td>
<td style="text-align: right;">15714</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: left;">-2361.41 secs</td>
<td style="text-align: left;">46272.02 secs</td>
<td style="text-align: left;">974.84 secs</td>
<td style="text-align: right;">352269</td>
</tr>
<tr class="even">
<td style="text-align: left;">scene_time</td>
<td style="text-align: right;">129091</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: left;">-3441.62 secs</td>
<td style="text-align: left;">45727.24 secs</td>
<td style="text-align: left;">833.94 secs</td>
<td style="text-align: right;">255066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">commit_time</td>
<td style="text-align: right;">1666</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">-2316.48 secs</td>
<td style="text-align: left;">46333.45 secs</td>
<td style="text-align: left;">999.14 secs</td>
<td style="text-align: right;">355370</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">incident_type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">136</td>
<td style="text-align: left;">EMS: 106202, Med: 83002, Dis: 29614, Arr: 25091</td>
</tr>
<tr class="even">
<td style="text-align: left;">incident_type_code</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">136</td>
<td style="text-align: left;">321: 106202, 311: 83002, 611: 29614, 611: 25091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">station_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">117: 29631, 111: 27953, 118: 24993, 114: 23253</td>
</tr>
<tr class="even">
<td style="text-align: left;">unit_type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">E: 202394, R: 85252, EA: 61368, T: 42844</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 35%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 5%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cancelled_before_enroute_flag</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: left;">FAL: 395448, TRU: 11061</td>
</tr>
<tr class="even">
<td style="text-align: left;">cancelled_enroute_flag</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: left;">FAL: 288479, TRU: 118030</td>
</tr>
<tr class="odd">
<td style="text-align: left;">night_call_flag</td>
<td style="text-align: right;">1507</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: left;">FAL: 320580, TRU: 84422</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dispatch_dt</td>
<td style="text-align: right;">1666</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">2021-12-01 00:12:26</td>
<td style="text-align: left;">2025-11-20 15:58:30</td>
<td style="text-align: left;">2023-11-06 07:36:07</td>
<td style="text-align: right;">301390</td>
</tr>
<tr class="even">
<td style="text-align: left;">enroute_dt</td>
<td style="text-align: right;">15714</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: left;">2021-12-01 00:13:51</td>
<td style="text-align: left;">2025-11-20 15:59:12</td>
<td style="text-align: left;">2023-11-03 20:34:59</td>
<td style="text-align: right;">389441</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arrival_dt</td>
<td style="text-align: right;">129091</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: left;">2021-12-01 00:24:49</td>
<td style="text-align: left;">2025-11-20 16:04:25</td>
<td style="text-align: left;">2023-10-29 19:42:26</td>
<td style="text-align: right;">275961</td>
</tr>
<tr class="even">
<td style="text-align: left;">clear_dt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">2021-12-01 00:14:37</td>
<td style="text-align: left;">2025-11-20 16:19:22</td>
<td style="text-align: left;">2023-11-06 12:59:36</td>
<td style="text-align: right;">390459</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Timespan</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 32%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dispatch_hour</td>
<td style="text-align: right;">1666</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">14H 7M 14.4470000267029S</td>
<td style="text-align: right;">18000</td>
</tr>
<tr class="even">
<td style="text-align: left;">clear_hour</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">14H 15M 54.9869999885559S</td>
<td style="text-align: right;">18000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="variable-summary" class="level2">
<h2 class="anchored" data-anchor-id="variable-summary">Variable Summary</h2>
<section id="incident-id" class="level3">
<h3 class="anchored" data-anchor-id="incident-id">Incident ID</h3>
<p>There are 257,959 unique incident ids in this dataset, whereas there are 406,509 rows in the dataset. This suggests an average of 1.58 units respond to each call.</p>
</section>
<section id="timespans" class="level3">
<h3 class="anchored" data-anchor-id="timespans">Timespans</h3>
<p>These features were calculated in <code>01_data_prep.r</code>. These values are in seconds. All of the mins of these features are negative. Let’s investigate them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_negative_turnout_time =</span> <span class="fu">sum</span>(turnout_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_travel_time =</span> <span class="fu">sum</span>(travel_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_scene_time =</span> <span class="fu">sum</span>(scene_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_commit_time =</span> <span class="fu">sum</span>(commit_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9f800822e2b4e077fa19" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9f800822e2b4e077fa19">{"x":{"filter":"none","vertical":false,"data":[["1"],[20],[15],[7],[7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>n_negative_turnout_time<\/th>\n      <th>n_negative_travel_time<\/th>\n      <th>n_negative_scene_time<\/th>\n      <th>n_negative_commit_time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"n_negative_turnout_time","targets":1},{"name":"n_negative_travel_time","targets":2},{"name":"n_negative_scene_time","targets":3},{"name":"n_negative_commit_time","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Exploring this further, we see that there are very few negative values. These can be safely excluded. Looking at the maximum values, we see 46,333 seconds. This equates to 12.87 hours, which may be possible for some very long structure fire cases. We will examine this further.</p>
<section id="turnout-time" class="level4">
<h4 class="anchored" data-anchor-id="turnout-time">Turnout Time</h4>
<p>The time between a unit being dispatched and going en route. Missing values may be due to dispatcher error, station walk-ins, or being dispatched and cancelled before going en route.</p>
</section>
<section id="travel-time" class="level4">
<h4 class="anchored" data-anchor-id="travel-time">Travel Time</h4>
<p>The time between going en route and arriving on scene. Missing values generally correspond to the apparatus being cancelled en route.</p>
</section>
<section id="en-route-to-clear-time" class="level4">
<h4 class="anchored" data-anchor-id="en-route-to-clear-time">En Route to Clear Time</h4>
<p>The time between going to en route and clearing. This is useful for estimating the travel time for apparatus that were cancelled en route.</p>
</section>
<section id="scene-time" class="level4">
<h4 class="anchored" data-anchor-id="scene-time">Scene Time</h4>
<p>The time between arriving on scene and the clear time. Missing values also correspond to being cancelled en route.</p>
</section>
<section id="commit-time" class="level4">
<h4 class="anchored" data-anchor-id="commit-time">Commit Time</h4>
<p>The time between a unit being dispatched and being cleared, or the sum of turnout, travel, and scene time. Since all calls without a clear time or dispatch time were removed in data prep, this has 100% completion.</p>
</section>
</section>
<section id="factors" class="level3">
<h3 class="anchored" data-anchor-id="factors">Factors</h3>
<section id="incident-type" class="level4">
<h4 class="anchored" data-anchor-id="incident-type">Incident Type</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(incident_type_code, incident_type) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2fe2d1a30dfc4f7f26aa" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2fe2d1a30dfc4f7f26aa">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136"],["321","311","611","611CS","554","622","322","324","745","321R","111","651","552","735","412","553","4601","522","743","131","142","561","113","531","551","733","445","511","746","444","353","323","744","424","151","352","118","736","731A","715","154","661","631","341","112","143","441","741","132","381","411","251","652","461","331","363","114","162","442","161","542","711","141","463","714","911","814","422","731","671","653","571","621","116","160","121","555","138","342","541","423","713","123","462","152","354","351","512","812","413","712","357","900F","521","115","365","421","734","221","742","641","721","361","813","322M","451","732","122","356","481","243","443","117","137","153","155","355","900P","471","672","223","371","372","815","163","134","211","231","322E","362","173","751","241","482","242","244"],["EMS call, excluding vehicle accident with injury","Medical assist, assist EMS crew","Dispatched and cancelled en route","Arrived and cancelled on scene","Assist invalid","No incident found on arrival at dispatch address","Motor vehicle accident with injuries","Motor vehicle accident with no injuries.","Alarm system activation, no fire - unintentional","EMS call, PATIENT REFUSED TREATMENT AND TRANSPORT","Building fire","Smoke scare, odor of smoke","Police matter","Alarm system sounded due to malfunction","Gas leak (natural gas or LPG)","Public service","Accident, potential accident, (Tree Down Roadway)","Water or steam leak","Smoke detector activation, no fire - unintentional","Passenger vehicle fire","Brush or brush-and-grass mixture fire","Unauthorized burning","Cooking fire, confined to container","Smoke or odor removal","Assist police or other governmental agency","Smoke detector activation due to malfunction","Arcing, shorted electrical equipment","Lock-out","Carbon monoxide detector activation, no CO","Power line down","Removal of victim(s) from stalled elevator","Motor vehicle/pedestrian accident (MV Ped)","Detector activation, no fire - unintentional","Carbon monoxide incident","Outside rubbish, trash or waste fire","Extrication of victim(s) from vehicle","Trash or rubbish fire, contained","CO detector activation due to malfunction","Fire Sprinkler Disabled ie. freezing/broken piping","Local alarm system, malicious false alarm","Dumpster or other outside trash receptacle fire","EMS call, party transported by non-fire agency","Authorized controlled burning","Search for person on land","Fires in structure other than in a building","Grass fire","Heat from short circuit (wiring), defective/worn","Sprinkler activation, no fire - unintentional","Road freight or transport vehicle fire","Rescue or EMS standby","Gasoline or other flammable liquid spill","Excessive heat, scorch burns with no ignition","Steam, vapor, fog or dust thought to be smoke","Building or structure weakened or collapsed","Lock-in (if lock out , use 511 )","Swift water rescue","Chimney or flue fire, confined to chimney or flue","Outside equipment fire","Overheated motor","Outside storage fire","Animal rescue","Municipal alarm system, malicious false alarm","Forest, woods or wildland fire","Vehicle accident, general cleanup","Central station, malicious false alarm","Citizen complaint","Lightning strike (no fire)","Chemical spill or leak","Sprinkler activation due to malfunction","HazMat release investigation w/no HazMat","Smoke from barbecue, tar kettle","Cover assignment, standby, moveup","Wrong location","Fuel burner/boiler malfunction, fire confined","Special outside fire, other","Fire in mobile home used as fixed residence","Defective elevator, no occupants","Off-road vehicle or heavy equipment fire","Search for person in water","Animal problem","Refrigeration leak","Telephone, malicious false alarm","Fire in portable building, fixed location","Aircraft standby","Garbage dump or sanitary landfill fire","Trench/below-grade rescue","Extrication of victim(s) from building/structure","Ring or jewelry removal","Flood assessment","Oil or other combustible liquid spill","Direct tie to FD, malicious false alarm","Extrication of victim(s) from machinery","Fire Investigation's Follow-up","Water evacuation","Incinerator overload or malfunction, fire confined","Watercraft rescue","Chemical hazard (no spill or leak)","Heat detector activation due to malfunction","Overpressure rupture of air or gas pipe/pipeline","Extinguishing system activation","Vicinity alarm (incident in other location)","Bomb scare - no bomb","Swimming/recreational water areas rescue","Wind storm, tornado/hurricane assessment","Motorcycle accident with injuries","Biological hazard, confirmed or suspected","Extinguishing system activation due to malfunction","Fire in motor home, camper, recreational vehicle","High-angle rescue","Attempt to burn","Fireworks explosion (no fire)","Breakdown of light ballast","Commercial Compactor fire, confined to rubbish","Camper or recreational vehicle (RV) fire","Construction or demolition landfill fire","Outside stationary compactor/compacted trash fire","Confined space rescue","Public Relations Event","Explosive, bomb removal (for bomb scare, use 721)","Biological hazard investigation, none found","Air or gas rupture of pressure or process vessel","Electrocution or potential electrocution","Trapped by power lines","Severe weather or natural disaster standby","Outside gas or vapor combustion explosion","Water vehicle fire","Overpressure rupture of steam pipe or pipeline","Chemical reaction rupture of process vessel","Motor vehicle accident with ejection","Ice rescue","Cultivated trees or nursery stock fire","Biological hazard, malicious false report","Munitions or bomb explosion (no fire)","Threat to burn","Blasting agent explosion (no fire)","Dust explosion (no fire)"],[106202,83002,29614,25091,20340,19004,12776,10512,9028,8960,8340,7686,6964,5201,4123,3735,3006,2833,2625,2271,2208,2128,1919,1849,1830,1577,1375,1366,1347,1341,913,797,765,705,603,580,561,556,533,527,515,500,497,460,439,428,411,396,393,391,345,313,291,274,272,268,261,249,247,241,216,212,195,194,193,185,171,157,157,155,147,138,132,122,114,106,101,98,93,92,80,79,73,70,69,63,58,57,54,53,51,47,39,38,37,37,36,35,34,33,32,31,30,30,25,24,24,23,20,20,19,19,18,15,15,15,15,15,14,13,10,10,9,8,7,6,6,6,5,5,4,4,3,2,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>incident_type_code<\/th>\n      <th>incident_type<\/th>\n      <th>count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"incident_type_code","targets":1},{"name":"incident_type","targets":2},{"name":"count","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>There are 136 unique incident types with the most common ones being medical calls, assists, cancelled en routes, motor vehicle accidents, and alarm activations. Medical assist calls are defined as the fire department using only manpower to assist an ambulance company. Some of these calls likely could be handled by the ambulance only since the department this data was gathered from uses third-party ambulance services to transport their patients. The high volume of assists, cancelled incidents, and alarms suggests that there could be room for improvement if these patterns are also present at night. We will analyze these further.</p>
</section>
<section id="station-id" class="level4">
<h4 class="anchored" data-anchor-id="station-id">Station ID</h4>
<p>There are 29 stations that have been randomly mapped to anonymous values.</p>
</section>
<section id="unit-type" class="level4">
<h4 class="anchored" data-anchor-id="unit-type">Unit Type</h4>
<p>This field was computed by splitting out the station and categorical component from the original value. For example, if the original callsign was E129, then unit type becomes ‘E’ and the station ‘129’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(unit_type) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a4d96dc294ffebb67a40" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a4d96dc294ffebb67a40">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["E","R","EA","T","SQ","H","AIR","MED","DIST","BOAT","TRAIL","MEDOPS","UT","AE","MEDOP","TMHK","CLPS","DECON","SE","AT","DC","ST","CONSP","HELO","MET","SM"],[202394,85252,61368,42844,9681,1770,1243,1222,258,134,120,77,63,17,15,12,11,10,5,3,3,3,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>unit_type<\/th>\n      <th>count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"unit_type","targets":1},{"name":"count","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>There are 26 unit types, but engines (E), rescues (R), ALS engines (EA), trucks (T), squads (SQ), hazmat trucks (H), and air trucks (AIR) run the vast majority of all calls. All other vehicle types are specialty units.</p>
</section>
</section>
<section id="logical-flags" class="level3">
<h3 class="anchored" data-anchor-id="logical-flags">Logical Flags</h3>
<section id="cancelled-before-en-route" class="level4">
<h4 class="anchored" data-anchor-id="cancelled-before-en-route">Cancelled Before En Route</h4>
<p>This is true if both en route time and arrival time are missing. Only 3% of calls are cancelled before they go en route.</p>
</section>
<section id="cancelled-en-route" class="level4">
<h4 class="anchored" data-anchor-id="cancelled-en-route">Cancelled En Route</h4>
<p>This is true if there is an en route time but no arrival time. 29% of unit responses were classified as cancelled en route. Incident types can also be cancelled en route (611), suggesting that all dispatched units did not arrive, or and arrived and cancelled (611CS) suggesting that they were cancelled shortly after arrival.</p>
</section>
<section id="night-call" class="level4">
<h4 class="anchored" data-anchor-id="night-call">Night Call</h4>
<p>Calls are classified as night calls if their dispatch to clear time overlaps with 22:00-06:00. This could be refined further by taking into account travel time back to the station in the case of calls that end just before 2200. We will keep it simple for now.</p>
</section>
</section>
<section id="timestamps" class="level3">
<h3 class="anchored" data-anchor-id="timestamps">Timestamps</h3>
<section id="dispatch" class="level4">
<h4 class="anchored" data-anchor-id="dispatch">Dispatch</h4>
<p>This is the time the dispatcher dispatches the unit. It represents the first time a crew is notified of a call and will be the time that they wake up if they are sleeping.</p>
</section>
<section id="en-route" class="level4">
<h4 class="anchored" data-anchor-id="en-route">En Route</h4>
<p>This time represents when the units will go en route. Either a crew can press a button in the apparatus to record this automatically or call into dispatch. 4% of the values are missing, likely due to being cancelled before going en route or due to dispather error.</p>
</section>
<section id="arrival" class="level4">
<h4 class="anchored" data-anchor-id="arrival">Arrival</h4>
<p>This time represents when the unit arrives on scene. 32% of these values are missing, most likely due to being cancelled en route.</p>
</section>
<section id="clear" class="level4">
<h4 class="anchored" data-anchor-id="clear">Clear</h4>
<p>When the unit is cleared off the scene.</p>
</section>
</section>
<section id="hours" class="level3">
<h3 class="anchored" data-anchor-id="hours">Hours</h3>
<section id="dispatch-and-clear-hours" class="level4">
<h4 class="anchored" data-anchor-id="dispatch-and-clear-hours">Dispatch and Clear Hours</h4>
<p>These are the time of day/night when the incident was dispatched or cleared. Used to calculate the nighttime flag, and could be useful for assessing the nighttime call distribution.</p>
</section>
</section>
</section>
<section id="additional-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="additional-cleaning">Additional Cleaning</h2>
<p>We identified a few issues that need to be corrected. First we remove all time spans below 0 because they are obviously due to a technical error. Additionally, there are 1666 missing dispatch times, which make our commit time also null. We remove those because our analysis depends on measuring the total commit time. We will retain</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="ot">&lt;-</span> incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dispatch_dt),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         turnout_time <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(turnout_time),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         travel_time <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(travel_time),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         enroute_to_clear_time <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(travel_time),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         scene_time <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(scene_time),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         commit_time <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span>(commit_time))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_na_dispatch_time =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(dispatch_dt)),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_turnout_time =</span> <span class="fu">sum</span>(turnout_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_travel_time =</span> <span class="fu">sum</span>(travel_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_enroute_to_clear_time =</span> <span class="fu">sum</span>(enroute_to_clear_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_scene_time =</span> <span class="fu">sum</span>(scene_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_negative_commit_time =</span> <span class="fu">sum</span>(commit_time <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cd36e93ab1fe02279885" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cd36e93ab1fe02279885">{"x":{"filter":"none","vertical":false,"data":[["1"],[0],[0],[0],[0],[0],[0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>n_na_dispatch_time<\/th>\n      <th>n_negative_turnout_time<\/th>\n      <th>n_negative_travel_time<\/th>\n      <th>n_negative_enroute_to_clear_time<\/th>\n      <th>n_negative_scene_time<\/th>\n      <th>n_negative_commit_time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"n_na_dispatch_time","targets":1},{"name":"n_negative_turnout_time","targets":2},{"name":"n_negative_travel_time","targets":3},{"name":"n_negative_enroute_to_clear_time","targets":4},{"name":"n_negative_scene_time","targets":5},{"name":"n_negative_commit_time","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="transformation-and-feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="transformation-and-feature-engineering">Transformation and Feature Engineering</h2>
<section id="sleep-timestamp" class="level3">
<h3 class="anchored" data-anchor-id="sleep-timestamp">Sleep Timestamp</h3>
<p>We can estimate the time the crew could return to sleep under the assumptions that they returned to the station immediately after the clear time, it took the same amount of time as the travel time to get back, and it took them 15 minutes (900 sec) to return to sleep. If we had the real time location data of the apparatus, then we could estimate this with greater accuracy, since some calls may be back-to-back without returning to the station. We can account for this if the calculated sleep time overlaps with the next call’s dispatch time. We also need to consider cancelled before going en route and cancelled en route calls. To address this, we will create a new variable drive time that’s equal to travel time if the call has both en route and arrival timestamps and equal to enroute to clear time if the unit was cancelled and never arrived.</p>
<p><span class="math display">\[
\Delta t_{\text{drive}} =
\begin{cases}
0 &amp; \text{if cancelled before en route} \\
t_{\text{clear}} - t_{\text{enroute}} &amp; \text{if cancelled en route} \\
t_{\text{arrived}} - t_{\text{enroute}} &amp; \text{if arrived on scene}
\end{cases}
\]</span></p>
<p><span class="math display">\[
t_{\text{sleep}}
= t_{\text{disp}}
+ \Delta t_{\text{commit}}
+ \Delta t_{\text{drive}}
+ 900\ \text{sec}
\]</span></p>
<p>If a call comes in and the crew never goes in route, their sleep is disrupted and they get back to sleep after about 15 minutes. If they are dispatched and go en route but never arrive, then their commit time represents the time from waking up to getting cancelled. They will then</p>
</section>
<section id="impact-duration" class="level3">
<h3 class="anchored" data-anchor-id="impact-duration">Impact Duration</h3>
<p>After we have an estimated sleep time, we can calculate the total impact time of a call. This will be how much the dispatch to sleep timespan overlaps with the period from 22:00 to 06:00. If a call is dispatched at 20:01 and the estimated sleep time is 22:01, we don’t want to assume that 2 hours of sleep were impacted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>get_sleep_period_start_dt <span class="ot">=</span> <span class="cf">function</span>(dt) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">floor_date</span>(dt, <span class="at">unit =</span> <span class="st">'day'</span>) <span class="sc">+</span> <span class="dv">22</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>get_sleep_period_end_dt <span class="ot">=</span> <span class="cf">function</span>(dt) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">floor_date</span>(dt, <span class="at">unit =</span> <span class="st">'day'</span>) <span class="sc">+</span> <span class="dv">30</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">get_sleep_period_start_dt</span>(<span class="fu">as.POSIXct</span>(<span class="st">"2021-12-02 23:00:27 UTC"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-12-02 22:00:00 EST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_sleep_period_end_dt</span>(incident_unit_responses_df<span class="sc">$</span>dispatch_dt[<span class="dv">500</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-12-03 06:00:00 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>incident_unit_responses_df <span class="ot">&lt;-</span> incident_unit_responses_df <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(dispatch_dt),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">drive_time =</span> <span class="fu">case_when</span>(cancelled_enroute_flag <span class="sc">~</span> <span class="fu">difftime</span>(clear_dt, enroute_dt),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> travel_time),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">sleep_dt =</span> dispatch_dt <span class="sc">+</span> commit_time <span class="sc">+</span> drive_time <span class="sc">+</span> <span class="dv">900</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">impact_time =</span> <span class="fu">difftime</span>(dispatch_dt, sleep_dt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>